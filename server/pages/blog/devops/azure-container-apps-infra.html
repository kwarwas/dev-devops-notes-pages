<!DOCTYPE html><html lang="en" class="scroll-smooth"><head><meta charSet="utf-8"/><meta content="width=device-width, initial-scale=1" name="viewport"/><meta name="next-head-count" content="2"/><link rel="apple-touch-icon" sizes="76x76" href="/static/favicons/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/static/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/static/favicons/favicon-16x16.png"/><link rel="manifest" href="/static/favicons/site.webmanifest"/><link rel="mask-icon" href="/static/favicons/safari-pinned-tab.svg" color="#5bbad5"/><meta name="msapplication-TileColor" content="#000000"/><meta name="theme-color" content="#000000"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><link rel="preload" href="/_next/static/css/62005f9c501ff39a.css" as="style"/><link rel="stylesheet" href="/_next/static/css/62005f9c501ff39a.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-37c2acf876aec4aa.js" defer=""></script><script src="/_next/static/chunks/framework-109a728694328ca8.js" defer=""></script><script src="/_next/static/chunks/main-e836c5d9f22a1de8.js" defer=""></script><script src="/_next/static/chunks/pages/_app-d94d5b59a345f2bf.js" defer=""></script><script src="/_next/static/chunks/15-9b7e5cd9303b15ae.js" defer=""></script><script src="/_next/static/chunks/625-be6d507068b005df.js" defer=""></script><script src="/_next/static/chunks/460-607895ef3d3661ae.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5B...slug%5D-d340f341e8b3978b.js" defer=""></script><script src="/_next/static/uzOiltCAqFYxg1Kb0LjyT/_buildManifest.js" defer=""></script><script src="/_next/static/uzOiltCAqFYxg1Kb0LjyT/_ssgManifest.js" defer=""></script></head><body class="bg-white text-black antialiased dark:bg-gray-900 dark:text-white"><div id="__next"><script>!function(){try{var d=document.documentElement,c=d.classList;c.remove('light','dark');var e=localStorage.getItem('theme');if('system'===e||(!e&&true)){var t='(prefers-color-scheme: dark)',m=window.matchMedia(t);if(m.media!==t||m.matches){d.style.colorScheme = 'dark';c.add('dark')}else{d.style.colorScheme = 'light';c.add('light')}}else if(e){c.add(e|| '')}if(e==='light'||e==='dark')d.style.colorScheme=e}catch(e){}}()</script><div class="mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-6xl xl:px-0"><div class="flex h-screen flex-col justify-between"><header class="flex items-center justify-between py-10"><div><a aria-label="Dev/DevOps Notes" href="/"><div class="flex items-center justify-between"><div class="mr-3"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="344.564 330.278 111.737 91.218" width="53.87" height="43.61" role="img"><defs><linearGradient id="logo_svg__b" gradientUnits="userSpaceOnUse" x1="420.97" y1="331.28" x2="420.97" y2="418.5"><stop style="stop-color:#06b6d4;stop-opacity:1" offset="0%"></stop><stop style="stop-color:#67e8f9;stop-opacity:1" offset="100%"></stop></linearGradient><linearGradient id="logo_svg__d" gradientUnits="userSpaceOnUse" x1="377.89" y1="331.28" x2="377.89" y2="418.5"><stop style="stop-color:#06b6d4;stop-opacity:1" offset="0%"></stop><stop style="stop-color:#67e8f9;stop-opacity:1" offset="100%"></stop></linearGradient><path d="M453.3 331.28v28.57l-64.66 58.65v-30.08l64.66-57.14Z" id="logo_svg__a"></path><path d="M410.23 331.28v28.57l-64.67 58.65v-30.08l64.67-57.14Z" id="logo_svg__c"></path></defs><use xlink:href="#logo_svg__a" fill="url(#logo_svg__b)"></use><use xlink:href="#logo_svg__c" fill="url(#logo_svg__d)"></use></svg></div><div class="hidden h-6 text-2xl font-semibold sm:block">Dev/DevOps Notes</div></div></a></div><div class="flex items-center text-base leading-5"><div class="hidden sm:block"><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/blog">Blog</a><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/tags">Tags</a><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/about">About</a></div><button aria-label="Toggle Dark Mode" type="button" class="ml-1 mr-1 h-8 w-8 rounded p-1 sm:ml-4"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path></svg></button><div class="sm:hidden"><button type="button" class="ml-1 mr-1 h-8 w-8 rounded py-1" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg></button><div class="fixed top-24 right-0 z-10 h-full w-full transform bg-gray-200 opacity-95 duration-300 ease-in-out dark:bg-gray-800 translate-x-full"><button type="button" aria-label="toggle modal" class="fixed h-full w-full cursor-auto focus:outline-none"></button><nav class="fixed mt-8 h-full"><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/blog">Blog</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/tags">Tags</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/about">About</a></div></nav></div></div></div></header><main class="mb-auto"><div class="mt-24 text-center"><h1 class="text-3xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 sm:text-4xl sm:leading-10 md:text-5xl md:leading-14">Under Construction<!-- --> <span role="img" aria-label="roadwork sign">ðŸš§</span></h1></div></main><footer><div class="mt-16 flex flex-col items-center"><div class="mb-3 flex space-x-4"><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="mailto:info@dev-devops.com"><span class="sr-only">mail</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" role="img" class="fill-current text-gray-700 hover:text-blue-500 dark:text-gray-200 dark:hover:text-blue-400 h-6 w-6"><path d="M2.003 5.884 10 9.882l7.997-3.998A2 2 0 0 0 16 4H4a2 2 0 0 0-1.997 1.884z"></path><path d="m18 8.118-8 4-8-4V14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8.118z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://github.com"><span class="sr-only">github</span><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" role="img" class="fill-current text-gray-700 hover:text-blue-500 dark:text-gray-200 dark:hover:text-blue-400 h-6 w-6"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://facebook.com"><span class="sr-only">facebook</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" role="img" class="fill-current text-gray-700 hover:text-blue-500 dark:text-gray-200 dark:hover:text-blue-400 h-6 w-6"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://youtube.com"><span class="sr-only">youtube</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" role="img" class="fill-current text-gray-700 hover:text-blue-500 dark:text-gray-200 dark:hover:text-blue-400 h-6 w-6"><path d="M23.499 6.203a3.008 3.008 0 0 0-2.089-2.089c-1.87-.501-9.4-.501-9.4-.501s-7.509-.01-9.399.501a3.008 3.008 0 0 0-2.088 2.09A31.258 31.26 0 0 0 0 12.01a31.258 31.26 0 0 0 .523 5.785 3.008 3.008 0 0 0 2.088 2.089c1.869.502 9.4.502 9.4.502s7.508 0 9.399-.502a3.008 3.008 0 0 0 2.089-2.09 31.258 31.26 0 0 0 .5-5.784 31.258 31.26 0 0 0-.5-5.808zm-13.891 9.4V8.407l6.266 3.604z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com"><span class="sr-only">linkedin</span><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" role="img" class="fill-current text-gray-700 hover:text-blue-500 dark:text-gray-200 dark:hover:text-blue-400 h-6 w-6"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 0 1-2.063-2.065 2.064 2.064 0 1 1 2.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://twitter.com/Twitter"><span class="sr-only">twitter</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" role="img" class="fill-current text-gray-700 hover:text-blue-500 dark:text-gray-200 dark:hover:text-blue-400 h-6 w-6"><path d="M23.953 4.57a10 10 0 0 1-2.825.775 4.958 4.958 0 0 0 2.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 0 0-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 0 0-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 0 1-2.228-.616v.06a4.923 4.923 0 0 0 3.946 4.827 4.996 4.996 0 0 1-2.212.085 4.936 4.936 0 0 0 4.604 3.417 9.867 9.867 0 0 1-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 0 0 7.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0 0 24 4.59z"></path></svg></a></div><div class="mb-2 flex space-x-2 text-sm text-gray-500 dark:text-gray-400"><div>Dev/DevOps</div><div> â€¢ </div><div>Â© 2022</div><div> â€¢ </div><a href="/">Dev/DevOps Notes</a></div><div class="mb-8 text-sm text-gray-500 dark:text-gray-400"><a target="_blank" rel="noopener noreferrer" href="https://github.com/timlrx/tailwind-nextjs-starter-blog">Tailwind Nextjs Theme</a></div></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"mdxSource":"var Component=(()=\u003e{var m=Object.create;var i=Object.defineProperty;var u=Object.getOwnPropertyDescriptor;var h=Object.getOwnPropertyNames;var N=Object.getPrototypeOf,k=Object.prototype.hasOwnProperty;var g=(a,e)=\u003e()=\u003e(e||a((e={exports:{}}).exports,e),e.exports),y=(a,e)=\u003e{for(var s in e)i(a,s,{get:e[s],enumerable:!0})},l=(a,e,s,c)=\u003e{if(e\u0026\u0026typeof e==\"object\"||typeof e==\"function\")for(let r of h(e))!k.call(a,r)\u0026\u0026r!==s\u0026\u0026i(a,r,{get:()=\u003ee[r],enumerable:!(c=u(e,r))||c.enumerable});return a};var _=(a,e,s)=\u003e(s=a!=null?m(N(a)):{},l(e||!a||!a.__esModule?i(s,\"default\",{value:a,enumerable:!0}):s,a)),f=a=\u003el(i({},\"__esModule\",{value:!0}),a);var t=g((T,o)=\u003e{o.exports=_jsx_runtime});var A={};y(A,{default:()=\u003ew,frontmatter:()=\u003ez});var n=_(t()),z={title:\"Azure Container Apps infrastructure\",date:\"2022-10-09\",lastmod:\"2022-10-09\",tags:[\"devops\",\"azure\",\"container apps\",\"infrastructure\",\"terraform\",\"terraform cloud\"],draft:!0,summary:\"In this article we introduce Azure Container Apps infrastructure using IaC approach with Terraform Cloud.\",authors:[\"wlodziu\",\"kornel\"]};function p(a){let e=Object.assign({h2:\"h2\",a:\"a\",span:\"span\",p:\"p\",ul:\"ul\",li:\"li\",div:\"div\",pre:\"pre\",code:\"code\"},a.components),{TOCInline:s,Image:c}=e;return c||d(\"Image\",!0),s||d(\"TOCInline\",!0),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(e.h2,{id:\"overview\",children:[(0,n.jsx)(e.a,{href:\"#overview\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Overview\"]}),(0,n.jsx)(s,{toc:a.toc,exclude:\"Overview\",toHeading:3}),(0,n.jsxs)(e.h2,{id:\"intro\",children:[(0,n.jsx)(e.a,{href:\"#intro\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Intro\"]}),(0,n.jsx)(e.p,{children:\"This article shows how to create the required Azure infrastructure to run our applications under Azure Container Apps. For the Infrastructure as Code solution, we use Terraform scripts with Terraform Cloud free plan for state storage.\"}),(0,n.jsxs)(e.h2,{id:\"required-azure-resources\",children:[(0,n.jsx)(e.a,{href:\"#required-azure-resources\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Required Azure resources\"]}),(0,n.jsx)(e.p,{children:\"To deploy our applications under Azure Container Apps, we need additional Azure resources:\"}),(0,n.jsxs)(e.ul,{children:[(0,n.jsx)(e.li,{children:\"Resource Group\"}),(0,n.jsx)(e.li,{children:\"Container Apps Environment - an isolation boundary around groups of container apps\"}),(0,n.jsx)(e.li,{children:\"Log Analytics workspace - logs management, assign to Container Apps Environment\"}),(0,n.jsx)(e.li,{children:\"Azure Container Registry (ACR) - storage for docker images of our applications\"}),(0,n.jsx)(e.li,{children:\"User-Assigned Managed Identity - identity used by Azure Container Apps to pull images from ACR\"})]}),(0,n.jsx)(e.div,{children:(0,n.jsx)(c,{alt:\"azure-container-apps-infra-diagram\",src:\"/static/images/devops/azure-container-apps/azure-container-apps-infra-diagram.png\",width:\"457\",height:\"817\"})}),(0,n.jsx)(e.p,{children:\"The Terraform script will not manage Container Apps resources in our solution. It is possible to create them using Terraform, but we prefer using a PowerShell script. In the case of Azure Container App, the Container App definition contains a container image definition and application settings definition (via environment variables and secrets). That means that the Container App definition will be changed very often, probably during each deployment of a new version of our applications. Therefore, this is an application deployment process, and Terraform role is infrastructure management. Similarly to K8s, where Terraform is not used in most cases for deploying K8s objects, this is a job for other mechanisms like Kubernetes manifests or Helm Scripts.\"}),(0,n.jsxs)(e.h2,{id:\"terraform-azapi-provider\",children:[(0,n.jsx)(e.a,{href:\"#terraform-azapi-provider\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Terraform AzAPI provider\"]}),(0,n.jsx)(e.p,{children:\"At the moment of creating this article, the official Azure Terraform provider, the AzureRM provider, with the current version of 3.26.0, is not supporting Azure Container Apps nor Azure Container Apps Environment yet. However, while waiting for this support, it is possible to manage those Azure resources with Terraform using the Terraform AzAPI provider. The AzAPI provider is a very thin layer on top of the Azure ARM REST APIs. It can be used as an alternative solution for managing Azure resources that are not yet or may never be supported by the AzureRM provider.\"}),(0,n.jsxs)(e.p,{children:[\"More about the AzAPI provider: \",(0,n.jsx)(e.a,{href:\"https://registry.terraform.io/providers/Azure/azapi/latest/docs\",children:\"https://registry.terraform.io/providers/Azure/azapi/latest/docs\"})]}),(0,n.jsxs)(e.p,{children:[\"More about creating Azure Container Apps in Terraform: \",(0,n.jsx)(e.a,{href:\"https://techcommunity.microsoft.com/t5/fasttrack-for-azure/can-i-create-an-azure-container-apps-in-terraform-yes-you-can/ba-p/3570694\",children:\"https://techcommunity.microsoft.com/t5/fasttrack-for-azure/can-i-create-an-azure-container-apps-in-terraform-yes-you-can/ba-p/3570694\"})]}),(0,n.jsxs)(e.p,{children:[\"Microsoft documentation for managing Azure Container Apps Environment using the AzAPI Terraform provider: \",(0,n.jsx)(e.a,{href:\"https://learn.microsoft.com/en-us/azure/templates/microsoft.app/managedenvironments?pivots=deployment-language-terraform\",children:\"https://learn.microsoft.com/en-us/azure/templates/microsoft.app/managedenvironments?pivots=deployment-language-terraform\"})]}),(0,n.jsx)(e.p,{children:\"In summary, in our Terraform script, we use two different providers:\"}),(0,n.jsxs)(e.ul,{children:[(0,n.jsx)(e.li,{children:\"AzAPI provider for managing Azure Container Apps Environment resource (inside Azure API called Managed Environment)\"}),(0,n.jsx)(e.li,{children:\"AzureRM provider for managing all other Azure resources\"})]}),(0,n.jsxs)(e.h2,{id:\"terraform-code\",children:[(0,n.jsx)(e.a,{href:\"#terraform-code\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Terraform code\"]}),(0,n.jsx)(e.p,{children:\"For Terraform state storage and script execution, we use Terraform Cloud service with a free plan. Therefore, it is essential to provide Azure tenant and subscription data along with the Service Principal data in configuration for every provider. Terraform Cloud agent will use this Service Principal to access and modify resources under a given Azure tenant and subscription.\"}),(0,n.jsx)(e.pre,{className:\"language-hcl\",children:(0,n.jsxs)(e.code,{className:\"language-hcl code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"terraform\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"required_providers\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token property\",children:\"azurerm\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token property\",children:\"source\"}),\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"hashicorp/azurerm\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token property\",children:\"version\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"3.26.0\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token property\",children:\"azapi\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token property\",children:\"source\"}),\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Azure/azapi\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token property\",children:\"version\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"1.0.0\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"cloud\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token property\",children:\"organization\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"dev-devops\"'}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"workspaces\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token property\",children:\"name\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"azure_container_apps-dev\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsxs)(e.span,{className:\"token keyword\",children:[\"provider\",(0,n.jsx)(e.span,{className:\"token type variable\",children:' \"azurerm\" '})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"features\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token property\",children:\"subscription_id\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"\u003cyour-azure-subscription-id\u003e\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token property\",children:\"client_id\"}),\"       \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"\u003cyour-azure-service-principal-client-id\u003e\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token property\",children:\"client_secret\"}),\"   \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"\u003cyour-azure-service-principal-client-secret\u003e\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token property\",children:\"tenant_id\"}),\"       \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"\u003cyour-azure-tenant-id\u003e\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsxs)(e.span,{className:\"token keyword\",children:[\"provider\",(0,n.jsx)(e.span,{className:\"token type variable\",children:' \"azapi\" '})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token property\",children:\"subscription_id\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"\u003cyour-azure-subscription-id\u003e\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token property\",children:\"client_id\"}),\"       \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"\u003cyour-azure-service-principal-client-id\u003e\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token property\",children:\"client_secret\"}),\"   \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"\u003cyour-azure-service-principal-client-secret\u003e\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token property\",children:\"tenant_id\"}),\"       \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"\u003cyour-azure-tenant-id\u003e\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"locals\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token property\",children:\"location\"}),\"             \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"North Europe\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token property\",children:\"organization_name\"}),\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"dev-devops\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token property\",children:\"project_name\"}),\"         \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"aca\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token property\",children:\"environment_name\"}),\"     \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"dev\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token property\",children:\"resource_name_suffix\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,n.jsxs)(e.span,{className:\"token string\",children:['\"',(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"$\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"local\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token type variable\",children:\"organization_name\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),\"-\",(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"$\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"local\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token type variable\",children:\"project_name\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),\"-\",(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"$\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"local\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token type variable\",children:\"environment_name\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),'\"']}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token property\",children:\"tags\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token property\",children:\"Owner\"}),\"        \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),` local.organization_name\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token property\",children:\"Env\"}),\"          \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),` local.environment_name\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token property\",children:\"WorkloadName\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),` local.project_name\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token property\",children:\"Source\"}),\"       \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Terraform\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token property\",children:\"log_settings\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token property\",children:\"sku\"}),\"               \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"PerGB2018\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token property\",children:\"retention_in_days\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"30\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token property\",children:\"daily_quota_gb\"}),\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsxs)(e.span,{className:\"token keyword\",children:[\"resource \",(0,n.jsx)(e.span,{className:\"token type variable\",children:'\"azurerm_resource_group\"'})]}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"resource_group\"'}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token property\",children:\"name\"}),\"     \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,n.jsxs)(e.span,{className:\"token string\",children:['\"rg-',(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"$\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"local\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token type variable\",children:\"resource_name_suffix\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),'\"']}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token property\",children:\"location\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),` local.location\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token property\",children:\"tags\"}),\"     \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),` local.tags\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsxs)(e.span,{className:\"token keyword\",children:[\"resource \",(0,n.jsx)(e.span,{className:\"token type variable\",children:'\"azurerm_log_analytics_workspace\"'})]}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"log_analytics_workspace\"'}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token property\",children:\"name\"}),\"                \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,n.jsxs)(e.span,{className:\"token string\",children:['\"log-',(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"$\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"local\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token type variable\",children:\"resource_name_suffix\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),'\"']}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token property\",children:\"resource_group_name\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),` azurerm_resource_group.resource_group.name\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token property\",children:\"location\"}),\"            \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),` azurerm_resource_group.resource_group.location\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token property\",children:\"sku\"}),\"                 \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),` local.log_settings.sku\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token property\",children:\"retention_in_days\"}),\"   \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),` local.log_settings.retention_in_days\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token property\",children:\"daily_quota_gb\"}),\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),` local.log_settings.daily_quota_gb\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token property\",children:\"tags\"}),\"                \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),` local.tags\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsxs)(e.span,{className:\"token keyword\",children:[\"resource \",(0,n.jsx)(e.span,{className:\"token type variable\",children:'\"azapi_resource\"'})]}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"resource_managed_environment\"'}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token property\",children:\"type\"}),\"                   \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Microsoft.App/managedEnvironments@2022-03-01\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token property\",children:\"name\"}),\"                   \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,n.jsxs)(e.span,{className:\"token string\",children:['\"menv-',(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"$\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"local\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token type variable\",children:\"resource_name_suffix\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),'\"']}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token property\",children:\"location\"}),\"               \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),` azurerm_resource_group.resource_group.location\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token property\",children:\"parent_id\"}),\"              \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),` azurerm_resource_group.resource_group.id\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token property\",children:\"tags\"}),\"                   \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),` local.tags\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token property\",children:\"response_export_values\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"properties.staticIp\"'}),\", \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"properties.defaultDomain\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token property\",children:\"body\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),\" jsonencode(\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token property\",children:\"properties\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token property\",children:\"appLogsConfiguration\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token property\",children:\"destination\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"log-analytics\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token property\",children:\"logAnalyticsConfiguration\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token property\",children:\"customerId\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),` azurerm_log_analytics_workspace.log_analytics_workspace.workspace_id\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token property\",children:\"sharedKey\"}),\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),` azurerm_log_analytics_workspace.log_analytics_workspace.primary_shared_key\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token property\",children:\"zoneRedundant\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"false\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`)\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token property\",children:\"ignore_missing_property\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"true\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsxs)(e.span,{className:\"token keyword\",children:[\"resource \",(0,n.jsx)(e.span,{className:\"token type variable\",children:'\"azurerm_container_registry\"'})]}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"container_registry\"'}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token property\",children:\"name\"}),\"                          \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,n.jsxs)(e.span,{className:\"token string\",children:['\"cr',(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"$\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"replace\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"local\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token type variable\",children:\"resource_name_suffix\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"-\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),'\"']}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token property\",children:\"resource_group_name\"}),\"           \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),` azurerm_resource_group.resource_group.name\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token property\",children:\"location\"}),\"                      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),` azurerm_resource_group.resource_group.location\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token property\",children:\"sku\"}),\"                           \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Basic\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token property\",children:\"admin_enabled\"}),\"                 \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"false\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token property\",children:\"public_network_access_enabled\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"true\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token property\",children:\"network_rule_bypass_option\"}),\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"None\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token property\",children:\"tags\"}),\"                          \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),` local.tags\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsxs)(e.span,{className:\"token keyword\",children:[\"resource \",(0,n.jsx)(e.span,{className:\"token type variable\",children:'\"azurerm_user_assigned_identity\"'})]}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"user_assigned_identity\"'}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token property\",children:\"name\"}),\"                \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,n.jsxs)(e.span,{className:\"token string\",children:['\"id-',(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"$\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"local\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token type variable\",children:\"resource_name_suffix\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),'\"']}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token property\",children:\"resource_group_name\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),` azurerm_resource_group.resource_group.name\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token property\",children:\"location\"}),\"            \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),` azurerm_resource_group.resource_group.location\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token property\",children:\"tags\"}),\"                \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),` local.tags\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsxs)(e.span,{className:\"token keyword\",children:[\"resource \",(0,n.jsx)(e.span,{className:\"token type variable\",children:'\"azurerm_role_assignment\"'})]}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"role_assign\"'}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token property\",children:\"scope\"}),\"                            \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),` azurerm_container_registry.container_registry.id\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token property\",children:\"role_definition_name\"}),\"             \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"AcrPull\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token property\",children:\"principal_id\"}),\"                     \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),` azurerm_user_assigned_identity.user_assigned_identity.principal_id\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token property\",children:\"skip_service_principal_aad_check\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"true\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsxs)(e.p,{children:[\"Please mind the \",(0,n.jsx)(e.code,{children:\"ignore_missing_property = true\"}),\" attribute setting for the managed environment resource. Adding this line is necessary to avoid problems with Terraform plan still founding changes after applying the configuration. More about this: \",(0,n.jsx)(e.a,{href:\"https://registry.terraform.io/providers/Azure/azapi/latest/docs/guides/frequently_asked_questions\",children:\"https://registry.terraform.io/providers/Azure/azapi/latest/docs/guides/frequently_asked_questions\"})]}),(0,n.jsxs)(e.h2,{id:\"terraform-cloud\",children:[(0,n.jsx)(e.a,{href:\"#terraform-cloud\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Terraform Cloud\"]}),(0,n.jsx)(e.p,{children:\"This is how the applied configuration looks like inside Terraform Cloud workspace:\"}),(0,n.jsx)(e.div,{children:(0,n.jsx)(c,{alt:\"azure-container-apps-infra-terraform-cloud\",src:\"/static/images/devops/azure-container-apps/azure-container-apps-infra-terraform-cloud.png\",width:\"798\",height:\"1066\"})}),(0,n.jsxs)(e.h2,{id:\"azure-portal\",children:[(0,n.jsx)(e.a,{href:\"#azure-portal\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Azure Portal\"]}),(0,n.jsx)(e.p,{children:\"This is how the applied configuration looks like on the Azure portal:\"}),(0,n.jsx)(e.div,{children:(0,n.jsx)(c,{alt:\"azure-container-apps-infra-azure-portal\",src:\"/static/images/devops/azure-container-apps/azure-container-apps-infra-azure-portal.png\",width:\"729\",height:\"727\"})})]})}function v(a={}){let{wrapper:e}=a.components||{};return e?(0,n.jsx)(e,Object.assign({},a,{children:(0,n.jsx)(p,a)})):p(a)}var w=v;function d(a,e){throw new Error(\"Expected \"+(e?\"component\":\"object\")+\" `\"+a+\"` to be defined: you likely forgot to import, pass, or provide it.\")}return f(A);})();\n;return Component;","toc":[{"value":"Overview","url":"#overview","depth":2},{"value":"Intro","url":"#intro","depth":2},{"value":"Required Azure resources","url":"#required-azure-resources","depth":2},{"value":"Terraform AzAPI provider","url":"#terraform-azapi-provider","depth":2},{"value":"Terraform code","url":"#terraform-code","depth":2},{"value":"Terraform Cloud","url":"#terraform-cloud","depth":2},{"value":"Azure Portal","url":"#azure-portal","depth":2}],"frontMatter":{"readingTime":{"text":"7 min read","minutes":6.325,"time":379500,"words":1265},"slug":"devops/azure-container-apps-infra","fileName":"devops/azure-container-apps-infra.mdx","title":"Azure Container Apps infrastructure","date":"2022-10-09T00:00:00.000Z","lastmod":"2022-10-09","tags":["devops","azure","container apps","infrastructure","terraform","terraform cloud"],"draft":true,"summary":"In this article we introduce Azure Container Apps infrastructure using IaC approach with Terraform Cloud.","authors":["wlodziu","kornel"]}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.63,"time":37800,"words":126},"slug":["wlodziu"],"fileName":"wlodziu.mdx","name":"WÅ‚odzimierz Kesler","avatar":"/static/images/wlodziu.jpg","occupation":"Team Leader / Senior Cloud Developer","company":"iteo","linkedin":"https://www.linkedin.com/in/wgkesler/","email":"wgkesler@gmail.com","date":null},{"readingTime":{"text":"1 min read","minutes":0.54,"time":32400,"words":108},"slug":["kornel"],"fileName":"kornel.mdx","name":"Kornel Warwas","avatar":"/static/images/kornel.jpeg","occupation":"Head of Web","company":"iteo","linkedin":"https://www.linkedin.com/in/kornel-warwas/","email":"kornel.warwas@gmail.com","github":"https://github.com/kwarwas","date":null}],"prev":null,"next":null},"__N_SSG":true},"page":"/blog/[...slug]","query":{"slug":["devops","azure-container-apps-infra"]},"buildId":"uzOiltCAqFYxg1Kb0LjyT","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>